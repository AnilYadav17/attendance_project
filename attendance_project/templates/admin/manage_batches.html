{% extends 'base.html' %}

{% block title %}Manage Batches - AMS{% endblock %}
{% block header_title %}Manage Batches{% endblock %}

{% block content %}
<button class="btn btn-primary" onclick="document.getElementById('addBatchModal').style.display='block'" style="margin-bottom: 20px;">Add Batch</button>

<div class="card">
    <h3>All Batches</h3>
    <div class="table-container">
        <table>
            <thead>
                    <th class="col-sno">S.No.</th>
                    <th class="col-name">Batch Name</th>
                    <th class="col-year">Year</th>
                    <th class="col-students">Students</th>
                    <th class="col-actions">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for batch in batches %}
                <tr>
                    <td class="col-sno">{{ forloop.counter }}</td>
                    <td class="col-name">{{ batch.name }}</td>
                    <td class="col-year">{{ batch.year }}</td>
                    <td class="col-students">{{ batch.students.count }}</td>
                    <td class="col-actions">
                        <div class="action-buttons">
                            <a href="{% url 'edit_batch' batch.id %}" class="btn btn-primary" style="padding: 6px 12px; font-size: 0.8rem; margin: 0; background: var(--primary-color); box-shadow: none;">Edit</a>
                            <form method="post" style="display: inline; margin: 0;" onsubmit="return confirm('Delete this batch?');">
                                {% csrf_token %}
                                <input type="hidden" name="delete" value="1">
                                <input type="hidden" name="batch_id" value="{{ batch.id }}">
                                <button type="submit" class="btn btn-danger" style="padding: 6px 12px; font-size: 0.8rem; margin: 0;">Delete</button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="5">No batches found.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Add Batch Modal -->
<div id="addBatchModal" class="modal" style="display:none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
    <div class="modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 40%; border-radius: 8px;">
        <span onclick="document.getElementById('addBatchModal').style.display='none'" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
        <h2>Add Batch</h2>
        <form method="post">
            {% csrf_token %}
            <div class="form-group">
                <label>Batch Name</label>
                <input type="text" name="name" class="form-control" placeholder="e.g., Class 10 A" required>
            </div>
            <div class="form-group">
                <label>Year</label>
                <input type="number" name="year" class="form-control" placeholder="e.g., 2024" required>
            </div>
            <button type="submit" class="btn btn-primary">Create Batch</button>
        </form>
    </div>
</div>
{% endblock %}
